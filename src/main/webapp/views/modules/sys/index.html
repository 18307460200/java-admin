<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>一个基础架子后台管理系统</title>

<!--     <script src="../resources/js-plug/md5.js"></script> -->
<!--     <link href="../resources/style/sys.css" rel="stylesheet" /> -->


    <link href="../../common/all.css" rel="stylesheet">
<script type="text/javascript" src="../../common/all.js"></script>

    
    <link href="../resources/style/login.style.css" rel="stylesheet" />
    <!--[if IE 6]>
        <script src="../resources/js-plug/jquery.fix/EvPng.js"></script>
        <script type="text/javascript">
            EvPNG.fix(".content-form");
        </script>
    <![endif]-->
</head>
<body>
    <div class="m-big-main">
        <div class="m-header">
            <div class="m-header-inner margin_auto">
                <div class="m-header-i-logo fn-left">
                    <div class="m-header-i-logo">
                        <div class="logo fn-left">
                            <img src="../resources/images/public/c-logo.jpg" alt="" />
                        </div>
                        <div class="headerfont fn-left">
                            <img src="../resources/images/public/c-header-left-font,.gif" alt="" />
                        </div>
                        <div class="fn-clear"></div>
                    </div>
                    <div class="fn-clear"></div>
                </div>
                <div class="m-header-i-font fn-right">
                    <div class="m-header-i-fontnum">
                        <div class="headerfontnum">
                            <img src="../resources/images/public/c-font.gif" alt="" />
                        </div>
                    </div>
                </div>
                <div class="fn-clear"></div>
            </div>
        </div>
        <div class="m-big-content">
            <div class="m-content">
                <div class="m-content-inner margin_auto">
                    <div class="content-form">
                        <div class="form-panel margin_auto">
                            <div class="form-panel-title"></div>
                            <div class="form-panel-input ">
                                <form class="form-horizontal" role="form" name="loginForm">
                                    <div class="form-group">
                                        <label class="fn-left control-label" id="_file">用户名：</label>
                                        <div class="fn-right input">
                                             <input type="text" id="username" maxlength="20" name="code" class="form-control"/>
                                        </div>
                                        <div class="fn-clear"></div>
                                    </div>
                                    <div class="form-group">
                                        <label for="inputPassword3" class="fn-left control-label">密码：</label>
                                        <div class="fn-right input">
                                             <input type="password" id="password" name="password" class="form-control" onkeypress="if(event.keyCode==13){goLogin();}"  />
                                        </div>
                                        <div class="fn-clear"></div>
                                    </div>
                                    <div class="form-group">
                                        <div class="col-sm-offset-1 col-sm-10">
                                            <div class="checkbox fn-left">
                                                <label>
                                                    <input type="checkbox" id="rememberMe" name="rememberMe" onclick="this.value=this.checked?true:false;"/>
                                                    记住密码
                                                </label>
                                            </div>
                                            <div class="label fn-right">
                                                <label>
                                                    <a href="#">忘记密码？</a>
                                                </label>
                                            </div>
                                            <div class="fn-clear"></div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class="col-sm-offset-2 col-sm-10">
                                            <button type="button" class="submit_btn btn-default login_button" onclick="goLogin()">登录</button>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                        <div>
                            <div class="form-footfont margin_auto">
                                <img src="../resources/images/login/c-foot-font.jpg" alt="" />
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="m-big-footer">
            <div class="footer-main margin_auto">
                <div class="footer-inner">
                    <a href="#">关于我们</a>|
                    <a href="#">联系我们</a>|
                    <a href="#">版权所有</a>|
                    <a href="#">技术热线</a>|
                    <a href="#">帮助中心</a>
                    <a href="#"></a>
                </div>
                <div class="footer-copyright">Copyright© 2014 广东信誉通科技有限公司 版权所有 粤ICP备100000号</div>
            </div>
        </div>
    </div>


    <script type="text/javascript">
        var rememberMePassword="";
        $(function () 
        {
        	$.ajaxSetup ({cache: false });
        	
        	var form=document.forms["loginForm"];
        	$.getJSON(getContextPath()+"/api/authx/getRememberMe",{},function(resultBean)
   			{
   				if(resultBean.success)
   				{
   					form.code.value=resultBean.data[0];
   					form.password.value= resultBean.data[1];
   					form.rememberMe.checked=true;
   					rememberMePassword=resultBean.data[1];
   				}else{
   					form.code.value="";
   					form.password.value= "";
   					form.rememberMe.checked=false;
   				}
   				form.rememberMe.value=form.rememberMe.checked;
   			});
        });
        
        function goLogin() 
        {
        	if($("#username").val()==""){alert("用户名不能为空");return;}
        	if($("#password").val()==""){alert("密码不能为空");return;}
        	if(getLength($("#username").val())>20){alert("用户名不能大于20");return;}
        	var pwd=$("#password").val();
        	if(rememberMePassword=="" || rememberMePassword!=pwd){pwd=encryptByMd5(pwd);}
	       	topLoading();
	       	$.post(getContextPath()+"/api/authx/pc/login",{code:$("#username").val(),password:pwd,rememberMe:$("#rememberMe").val()},function(resultBean, status, xhRequest)
	   		{
	       		topLoaded();
	       		if(!handleAjaxRequest(resultBean, status,xhRequest))return;
	       		if(!resultBean.success){alert(resultBean.message);return;}
	       		window.location.href = getContextPath()+"/front/sys/main.html";
	   		},'json');	   					
        }        
    </script>
</body>
</html>
