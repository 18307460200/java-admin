<!DOCTYPE html>
<html>
<head>
<title>用户管理</title>

<!-- <link href="../../../common/bootstrap/css/bootstrap.min.css" -->
<!-- 	rel="stylesheet"> -->
<!-- <link href="../../resources/css/sys/pager.css" -->
<!-- 	rel="stylesheet"> -->
	
<!-- <script src="../../../common/jquery/jquery-1.12.3.js"></script> -->
<!-- <script src="../../../common/bootstrap/js/bootstrap.js"></script> -->
<!-- <script src="../../../common/bootstrap/js/bootstrap.js"></script> -->
<!-- <script type="text/javascript"  src="../../../common/sys.js"></script> -->
<!-- <script type="text/javascript"  src="../../../common/util/common.js"></script> -->
<!-- <script type="text/javascript"> -->


<link href="../../../common/all.css" rel="stylesheet">
<script type="text/javascript" src="../../../common/all.js"></script>

</script>
</head>
<!-- <div style="padding: 15px 10px;font: 9px" > -->
<!-- 系统管理>用户管理 -->
<!-- </div> -->
<body style="overflow-x: hidden; overflow-y: hidden;">
<!-- 	<div> -->
<!-- 		<a href="#" class="btn btn-primary">新增用户</a> -->
<!-- 	</div> -->
	
<!-- 	<ul class="nav nav-tabs"> -->
<!-- 		<li class="active"> -->
<!-- 			<a href="javascript:aHref('/sys/user/list');">用户列表</a> -->
<!-- 		</li> -->
<!-- 		<li> -->
<!-- 			<a href="javascript:aHref('/views/sys/user/userAdd.html');">新增用户</a> -->
<!-- 		</li> -->
<!-- 	</ul> -->


	<ul class="nav nav-tabs">
		<li class="active">
			<a href="userlist.html">用户列表</a>
		</li>
		<li>
			<a href="userAdd.html">新增用户</a>
		</li>
	</ul>

	<div class="panel panel-default">
		<table id="_user_table" class="table table-striped">
			<thead>
				<tr>
					<th>序号</th>
					<th>id</th>
					<th>用户名</th>
					<th>状态</th>
					<th>创建时间</th>
					<th>操作</th>
				</tr>
			</thead>

			<tbody>
				
			</tbody>

		</table>

    <div class="pagination" id="_pagination">
    
</div>
	
	
	
<script type="text/javascript">

//初始化
$(function() {
	var param=new Object();	
	    param.status="0";
	//初始化数据	
	pageFn(getContextPath()+"/sys/user/list",param);
})


/**分页回调处理**/
function callbak_page(returnDatas)
{
	//alert(JSON.stringify(returnDatas));
	
	var tableHTML = "";
	var trContext = $("#_user_table");
	//$("#_user_table tbody tr").eq(0).nextAll().remove();
	$("#_user_table tbody tr").remove();
	var returnData = returnDatas.data.items;
	
	if(returnData==null){
	  return;
	}
	for (var i = 0; i < returnData.length; i++) {
	var j=i;
	//状态处理
	//var sta=returnData[i].status;
	var staName="";
	var operation='<a href="#">查看</a>'
				   +'&nbsp;&nbsp;<a href="#">修改</a>'
				   +'&nbsp;&nbsp;<a href="#">删除</a>';
				   
	tableHTML += "<tr>" + "<td>"
				+ (j + 1)
				+ "</td>"
				+ "<td>"
				+ returnData[i].id
				+ "</td>"
				+ "<td>"
				+ returnData[i].userName
				+ "</td>"										
				+ "<td>"
				+ returnData[i].status
				+ "</td>"
				+ "<td>"
				+ returnData[i].departmentId
				+ "</td>"						
				+ "<td>"
				+operation									
				+"</td>" 
				+ "</tr>"
	
	}
	trContext.append(tableHTML);

}

//查询
$("#_search_id").click(
	function(){
	   var param=getParam();
	   sendReq("${pagecontext.request.contextpath}/audit/enterprise/getlist.do",param);
});

//获取参数处理
function getParam()
{				
	  var param=new Object();	
	  //时间处理
	  var dateVar= $("#_search_date_id").val();					 
	  var startDt=$("#d12").val();
	  var endDt=$("#d13").val();
		
	 if(dateVar==1)
	 {
	   
		if(startDt!=""&&endDt!="")
		{
		   param.applyStartDt=startDt;
		   param.applyEndDt=endDt;
		}
	   
	 }else if(dateVar==2)
	 {
	 
		if(startDt!=""&&endDt!="")
		{
		   param.inStartDt=startDt;
		   param.inEndDate=endDt;
		}
	 
	 }
	 //状态
	 var statusVar=$("#search_status_id").val();	
	 if(statusVar!=0)
	 {
		param.status=statusVar;
	 }				 
	
	 //内容查询
	 var contextVar= $("#search_context_id").val();			
	 if(contextVar!="")
	 { 
		  var contextName=$("#search_project_id").val();
		  if(contextName==1)
		  {
			param.companyName=contextVar;
		  }else if(contextName==2)
		  {
			param.loginName=contextVar;
		  }
	
	 }
	 
	 //地区
	var areaCode= $("#areaCodeV").val();
	 if(areaCode!=""){
		 param.area=areaCode;
	 }
	 
	 //支付方式
	 var  payManner= $("#payWay").val();
	 if(payManner!=0){
		 param.payManner=payManner;
	 }
	 
	 
	return param;			 
}



  
  
  
  /**操作*/
  function updateStatus(id,status)
  {
	  
	  yb.dialog({title: "系统提示", content: "确定吗？", btn: {"确定": {"updateStatusEnter":[id,status]}, "取消": ""}});

  
  }
  
  function updateStatusEnter(id,status)
  {
	  // alert(id+"=="+status);
	    $.post("${pagecontext.request.contextpath}/audit/enterprise/updateStatus.do",
		  {"id":id,"status":status},
		  function(returnDatas,status)
		  {
			   if(status=="success")
			   { 
			     yb.alert("操作成功");
				 //初始化数据	
		        // pageFn("${pagecontext.request.contextpath}/audit/enterprise/getlist.do");
		           var param=getParam();
	               sendReq("${pagecontext.request.contextpath}/audit/enterprise/getlist.do",param);
			
			   }else
			   {
				  alert("系统异常!");
			   }
		  });
	  
  }
		




/***加入服务**/
function addService(userid)
{

    //取值
  $.ajax({
			type : "POST",
			url : "${pagecontext.request.contextpath}/audit/interact/addService.do",
			//dataType:"json",
			data : "userId="+userid,
			//contentType : "application/json",
			success : function(returnDatas,status) 
			{
			   if(resolveResultBeanIsOk(returnDatas,status))
			   {
			     var param=getParam();
				 sendReq("${pagecontext.request.contextpath}/audit/interact/getlist.do",param);
			   }
			},
			error : function(XMLHttpRequest, textStatus, errorThrown) {							
				 yb.alert('系统异常;');
			}
		});	
	 
	 
}






</script>

</body>
</html>